Using the latest cached version of the dataset since simonjegou/loogle couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration 'longdep_qa' at /lustre/fsn1/projects/rech/awr/uof65ov/hf_cache/simonjegou___loogle/longdep_qa/0.0.0/6e3eaf28d24ce34933170c85de36be2448d0d2a7 (last modified on Mon Nov 25 15:20:17 2024).
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  6.31it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.76it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.72it/s]
  0%|          | 0/140 [00:00<?, ?it/s]The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
  1%|          | 1/140 [00:25<58:16, 25.16s/it]  1%|▏         | 2/140 [00:53<1:02:17, 27.08s/it]  2%|▏         | 3/140 [01:10<51:12, 22.42s/it]    3%|▎         | 4/140 [01:25<44:14, 19.52s/it]  4%|▎         | 5/140 [01:47<45:34, 20.25s/it]  4%|▍         | 6/140 [02:45<1:14:32, 33.37s/it]  5%|▌         | 7/140 [04:16<1:55:25, 52.07s/it]  6%|▌         | 8/140 [04:48<1:40:34, 45.72s/it]  6%|▋         | 9/140 [05:06<1:20:40, 36.95s/it]  7%|▋         | 10/140 [05:15<1:01:50, 28.54s/it]You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  8%|▊         | 11/140 [05:41<59:25, 27.64s/it]    9%|▊         | 12/140 [06:07<58:06, 27.24s/it]  9%|▉         | 13/140 [06:30<54:42, 25.85s/it] 10%|█         | 14/140 [06:50<50:45, 24.17s/it] 11%|█         | 15/140 [07:20<53:55, 25.88s/it] 11%|█▏        | 16/140 [08:00<1:02:25, 30.21s/it] 12%|█▏        | 17/140 [08:25<58:44, 28.65s/it]   13%|█▎        | 18/140 [09:04<1:04:03, 31.50s/it] 14%|█▎        | 19/140 [09:49<1:11:53, 35.64s/it] 14%|█▍        | 20/140 [10:07<1:00:44, 30.37s/it] 15%|█▌        | 21/140 [10:31<56:33, 28.52s/it]   16%|█▌        | 22/140 [11:02<57:21, 29.17s/it] 16%|█▋        | 23/140 [11:21<51:03, 26.18s/it] 17%|█▋        | 24/140 [11:40<46:25, 24.01s/it] 18%|█▊        | 25/140 [11:51<38:29, 20.08s/it] 19%|█▊        | 26/140 [12:05<34:26, 18.13s/it] 19%|█▉        | 27/140 [12:25<35:34, 18.89s/it] 20%|██        | 28/140 [12:52<39:25, 21.12s/it] 21%|██        | 29/140 [13:20<43:07, 23.31s/it] 21%|██▏       | 30/140 [13:27<33:35, 18.32s/it] 22%|██▏       | 31/140 [13:48<34:50, 19.18s/it] 23%|██▎       | 32/140 [14:04<33:03, 18.37s/it] 24%|██▎       | 33/140 [15:02<53:44, 30.14s/it] 24%|██▍       | 34/140 [15:31<52:35, 29.77s/it] 25%|██▌       | 35/140 [15:43<42:45, 24.43s/it] 26%|██▌       | 36/140 [16:05<41:14, 23.80s/it] 26%|██▋       | 37/140 [16:34<43:16, 25.21s/it] 27%|██▋       | 38/140 [16:46<36:30, 21.48s/it] 28%|██▊       | 39/140 [16:54<29:00, 17.23s/it] 29%|██▊       | 40/140 [17:19<32:36, 19.56s/it] 29%|██▉       | 41/140 [18:10<47:48, 28.97s/it] 30%|███       | 42/140 [18:29<42:52, 26.25s/it] 31%|███       | 43/140 [18:47<38:15, 23.67s/it] 31%|███▏      | 44/140 [19:50<56:36, 35.38s/it] 32%|███▏      | 45/140 [20:05<46:30, 29.37s/it] 33%|███▎      | 46/140 [20:42<49:44, 31.75s/it] 34%|███▎      | 47/140 [21:07<45:45, 29.52s/it] 34%|███▍      | 48/140 [21:26<40:34, 26.46s/it] 35%|███▌      | 49/140 [21:43<35:47, 23.60s/it] 36%|███▌      | 50/140 [22:16<39:35, 26.39s/it] 36%|███▋      | 51/140 [22:45<40:17, 27.16s/it] 37%|███▋      | 52/140 [22:59<34:02, 23.21s/it] 38%|███▊      | 53/140 [23:21<33:09, 22.86s/it] 39%|███▊      | 54/140 [23:29<26:15, 18.32s/it] 39%|███▉      | 55/140 [23:36<21:28, 15.15s/it] 40%|████      | 56/140 [24:35<39:38, 28.31s/it] 41%|████      | 57/140 [24:42<30:04, 21.75s/it] 41%|████▏     | 58/140 [25:09<32:02, 23.44s/it] 42%|████▏     | 59/140 [25:35<32:39, 24.19s/it] 43%|████▎     | 60/140 [26:01<32:52, 24.65s/it] 44%|████▎     | 61/140 [26:22<30:55, 23.48s/it] 44%|████▍     | 62/140 [26:45<30:17, 23.31s/it] 45%|████▌     | 63/140 [27:14<32:17, 25.16s/it] 46%|████▌     | 64/140 [27:56<38:18, 30.25s/it] 46%|████▋     | 65/140 [28:26<37:39, 30.12s/it] 47%|████▋     | 66/140 [28:42<31:47, 25.77s/it] 48%|████▊     | 67/140 [29:07<31:13, 25.67s/it] 49%|████▊     | 68/140 [29:26<28:24, 23.67s/it] 49%|████▉     | 69/140 [29:39<24:06, 20.37s/it] 50%|█████     | 70/140 [30:01<24:34, 21.07s/it] 51%|█████     | 71/140 [30:18<22:41, 19.73s/it] 51%|█████▏    | 72/140 [30:24<17:43, 15.64s/it] 52%|█████▏    | 73/140 [30:44<18:48, 16.85s/it] 53%|█████▎    | 74/140 [30:57<17:27, 15.88s/it] 54%|█████▎    | 75/140 [31:08<15:24, 14.22s/it] 54%|█████▍    | 76/140 [31:24<15:49, 14.83s/it] 55%|█████▌    | 77/140 [31:33<13:39, 13.01s/it] 56%|█████▌    | 78/140 [31:53<15:32, 15.04s/it] 56%|█████▋    | 79/140 [32:05<14:24, 14.18s/it] 57%|█████▋    | 80/140 [32:19<14:20, 14.34s/it] 58%|█████▊    | 81/140 [32:39<15:34, 15.84s/it] 59%|█████▊    | 82/140 [32:53<14:55, 15.44s/it] 59%|█████▉    | 83/140 [33:20<17:52, 18.81s/it] 60%|██████    | 84/140 [33:43<18:42, 20.05s/it] 61%|██████    | 85/140 [34:18<22:24, 24.44s/it] 61%|██████▏   | 86/140 [34:42<22:02, 24.49s/it] 62%|██████▏   | 87/140 [35:31<28:02, 31.74s/it] 63%|██████▎   | 88/140 [36:12<29:59, 34.61s/it] 64%|██████▎   | 89/140 [36:36<26:38, 31.34s/it] 64%|██████▍   | 90/140 [36:59<24:02, 28.85s/it] 65%|██████▌   | 91/140 [37:27<23:26, 28.70s/it] 66%|██████▌   | 92/140 [38:10<26:14, 32.79s/it] 66%|██████▋   | 93/140 [38:36<24:09, 30.84s/it] 67%|██████▋   | 94/140 [38:48<19:24, 25.32s/it] 68%|██████▊   | 95/140 [39:23<21:07, 28.17s/it] 69%|██████▊   | 96/140 [39:33<16:31, 22.54s/it] 69%|██████▉   | 97/140 [40:01<17:28, 24.38s/it] 70%|███████   | 98/140 [40:18<15:21, 21.95s/it] 71%|███████   | 99/140 [40:29<12:52, 18.84s/it] 71%|███████▏  | 100/140 [41:04<15:47, 23.68s/it] 72%|███████▏  | 101/140 [41:31<16:04, 24.72s/it] 73%|███████▎  | 102/140 [41:53<15:05, 23.83s/it] 74%|███████▎  | 103/140 [42:26<16:25, 26.63s/it] 74%|███████▍  | 104/140 [42:41<13:48, 23.00s/it] 75%|███████▌  | 105/140 [43:57<22:44, 38.98s/it] 76%|███████▌  | 106/140 [44:42<23:09, 40.87s/it] 76%|███████▋  | 107/140 [44:57<18:14, 33.17s/it] 77%|███████▋  | 108/140 [45:13<14:51, 27.86s/it] 78%|███████▊  | 109/140 [45:32<13:05, 25.35s/it] 79%|███████▊  | 110/140 [46:22<16:16, 32.56s/it] 79%|███████▉  | 111/140 [46:45<14:23, 29.79s/it] 80%|████████  | 112/140 [46:57<11:26, 24.53s/it] 81%|████████  | 113/140 [47:33<12:28, 27.73s/it] 81%|████████▏ | 114/140 [47:44<09:51, 22.75s/it] 82%|████████▏ | 115/140 [48:00<08:42, 20.92s/it] 83%|████████▎ | 116/140 [48:14<07:31, 18.82s/it] 84%|████████▎ | 117/140 [48:34<07:22, 19.24s/it] 84%|████████▍ | 118/140 [48:42<05:44, 15.68s/it] 85%|████████▌ | 119/140 [49:13<07:09, 20.44s/it] 86%|████████▌ | 120/140 [49:38<07:13, 21.67s/it] 86%|████████▋ | 121/140 [49:58<06:44, 21.27s/it] 87%|████████▋ | 122/140 [50:13<05:50, 19.45s/it] 88%|████████▊ | 123/140 [50:34<05:34, 19.67s/it] 89%|████████▊ | 124/140 [50:45<04:34, 17.17s/it] 89%|████████▉ | 125/140 [50:58<04:00, 16.03s/it] 90%|█████████ | 126/140 [51:16<03:50, 16.44s/it] 91%|█████████ | 127/140 [51:33<03:38, 16.79s/it] 91%|█████████▏| 128/140 [51:54<03:34, 17.84s/it] 92%|█████████▏| 129/140 [52:04<02:51, 15.61s/it] 93%|█████████▎| 130/140 [52:14<02:17, 13.79s/it] 94%|█████████▎| 131/140 [52:48<03:00, 20.04s/it] 94%|█████████▍| 132/140 [53:00<02:21, 17.68s/it] 95%|█████████▌| 133/140 [53:17<02:02, 17.47s/it] 96%|█████████▌| 134/140 [53:50<02:12, 22.03s/it] 96%|█████████▋| 135/140 [54:07<01:42, 20.43s/it] 97%|█████████▋| 136/140 [54:42<01:39, 24.85s/it] 98%|█████████▊| 137/140 [55:18<01:24, 28.33s/it] 99%|█████████▊| 138/140 [55:46<00:56, 28.07s/it] 99%|█████████▉| 139/140 [56:17<00:28, 28.91s/it]100%|██████████| 140/140 [56:45<00:00, 28.71s/it]100%|██████████| 140/140 [56:45<00:00, 24.32s/it]
[nltk_data] Error loading wordnet: <urlopen error [Errno 101] Network
[nltk_data]     is unreachable>
/lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/venv/lib/python3.11/site-packages/nltk/translate/bleu_score.py:577: UserWarning: 
The hypothesis contains 0 counts of 2-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/venv/lib/python3.11/site-packages/nltk/translate/bleu_score.py:577: UserWarning: 
The hypothesis contains 0 counts of 3-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/venv/lib/python3.11/site-packages/nltk/translate/bleu_score.py:577: UserWarning: 
The hypothesis contains 0 counts of 4-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'longdep_qa': {'bleu1': 0.0936492638921439, 'bleu4': 0.011388266079479684, 'rouge-1': 0.30592377117335523, 'rouge-2': 0.101573251345984, 'rouge-l': 0.2923854404606896, 'meteor': 0.12632494968916066, 'bert': 0.8353732228279114}}
