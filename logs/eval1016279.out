Using the latest cached version of the dataset since simonjegou/loogle couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration 'longdep_qa' at /lustre/fsn1/projects/rech/awr/uof65ov/hf_cache/simonjegou___loogle/longdep_qa/0.0.0/6e3eaf28d24ce34933170c85de36be2448d0d2a7 (last modified on Mon Nov 25 15:20:17 2024).
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  6.10it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.59it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.50it/s]
  0%|          | 0/140 [00:00<?, ?it/s]The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
  1%|          | 1/140 [00:19<44:57, 19.40s/it]  1%|▏         | 2/140 [00:34<39:11, 17.04s/it]  2%|▏         | 3/140 [01:04<52:28, 22.98s/it]  3%|▎         | 4/140 [01:41<1:03:54, 28.19s/it]  4%|▎         | 5/140 [01:59<55:16, 24.57s/it]    4%|▍         | 6/140 [02:45<1:11:17, 31.92s/it]  5%|▌         | 7/140 [04:10<1:49:12, 49.27s/it]  6%|▌         | 8/140 [04:33<1:30:17, 41.04s/it]  6%|▋         | 9/140 [04:53<1:15:13, 34.46s/it]  7%|▋         | 10/140 [05:08<1:01:41, 28.47s/it]You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
  8%|▊         | 11/140 [05:39<1:02:25, 29.03s/it]  9%|▊         | 12/140 [06:13<1:05:27, 30.69s/it]  9%|▉         | 13/140 [06:33<58:21, 27.57s/it]   10%|█         | 14/140 [06:52<52:10, 24.85s/it] 11%|█         | 15/140 [07:27<57:58, 27.83s/it] 11%|█▏        | 16/140 [08:21<1:13:50, 35.73s/it] 12%|█▏        | 17/140 [08:47<1:07:05, 32.72s/it] 13%|█▎        | 18/140 [09:46<1:22:49, 40.73s/it] 14%|█▎        | 19/140 [10:34<1:26:32, 42.91s/it] 14%|█▍        | 20/140 [10:48<1:08:16, 34.13s/it] 15%|█▌        | 21/140 [11:14<1:03:00, 31.77s/it] 16%|█▌        | 22/140 [12:12<1:18:01, 39.67s/it] 16%|█▋        | 23/140 [12:27<1:02:45, 32.19s/it] 17%|█▋        | 24/140 [12:56<1:00:44, 31.42s/it] 18%|█▊        | 25/140 [13:07<48:00, 25.04s/it]   19%|█▊        | 26/140 [13:21<41:18, 21.74s/it] 19%|█▉        | 27/140 [13:46<43:03, 22.86s/it] 20%|██        | 28/140 [13:58<36:23, 19.50s/it] 21%|██        | 29/140 [14:20<37:24, 20.22s/it] 21%|██▏       | 30/140 [14:27<30:01, 16.38s/it] 22%|██▏       | 31/140 [15:04<40:58, 22.55s/it] 23%|██▎       | 32/140 [15:19<36:47, 20.44s/it] 24%|██▎       | 33/140 [16:09<51:46, 29.04s/it] 24%|██▍       | 34/140 [16:57<1:01:32, 34.83s/it] 25%|██▌       | 35/140 [17:07<47:57, 27.41s/it]   26%|██▌       | 36/140 [17:24<42:12, 24.35s/it] 26%|██▋       | 37/140 [17:40<37:29, 21.84s/it] 27%|██▋       | 38/140 [18:05<38:44, 22.78s/it] 28%|██▊       | 39/140 [18:12<30:29, 18.11s/it] 29%|██▊       | 40/140 [18:33<31:34, 18.94s/it] 29%|██▉       | 41/140 [19:10<40:02, 24.27s/it] 30%|███       | 42/140 [19:40<42:25, 25.98s/it] 31%|███       | 43/140 [20:14<45:50, 28.36s/it] 31%|███▏      | 44/140 [21:06<56:44, 35.46s/it] 32%|███▏      | 45/140 [21:26<48:47, 30.81s/it] 33%|███▎      | 46/140 [21:46<43:23, 27.70s/it] 34%|███▎      | 47/140 [22:09<40:48, 26.33s/it] 34%|███▍      | 48/140 [22:28<36:42, 23.94s/it] 35%|███▌      | 49/140 [22:46<33:29, 22.08s/it] 36%|███▌      | 50/140 [23:27<41:55, 27.95s/it] 36%|███▋      | 51/140 [23:38<33:48, 22.80s/it] 37%|███▋      | 52/140 [23:50<28:43, 19.59s/it] 38%|███▊      | 53/140 [24:33<38:32, 26.59s/it] 39%|███▊      | 54/140 [24:40<29:49, 20.81s/it] 39%|███▉      | 55/140 [24:48<23:59, 16.94s/it] 40%|████      | 56/140 [25:50<42:45, 30.54s/it] 41%|████      | 57/140 [25:58<32:29, 23.49s/it] 41%|████▏     | 58/140 [26:17<30:38, 22.42s/it] 42%|████▏     | 59/140 [27:01<38:54, 28.82s/it] 43%|████▎     | 60/140 [27:15<32:24, 24.31s/it] 44%|████▎     | 61/140 [27:49<35:50, 27.22s/it] 44%|████▍     | 62/140 [28:06<31:15, 24.05s/it] 45%|████▌     | 63/140 [28:24<28:50, 22.47s/it] 46%|████▌     | 64/140 [29:19<40:37, 32.07s/it] 46%|████▋     | 65/140 [29:45<37:59, 30.39s/it] 47%|████▋     | 66/140 [30:01<32:08, 26.06s/it] 48%|████▊     | 67/140 [30:19<28:44, 23.62s/it] 49%|████▊     | 68/140 [30:38<26:35, 22.16s/it] 49%|████▉     | 69/140 [30:48<22:00, 18.59s/it] 50%|█████     | 70/140 [31:07<21:50, 18.72s/it] 51%|█████     | 71/140 [31:33<23:58, 20.84s/it] 51%|█████▏    | 72/140 [31:40<18:57, 16.72s/it] 52%|█████▏    | 73/140 [32:07<22:06, 19.80s/it] 53%|█████▎    | 74/140 [32:20<19:25, 17.66s/it] 54%|█████▎    | 75/140 [32:32<17:21, 16.02s/it] 54%|█████▍    | 76/140 [32:49<17:16, 16.20s/it] 55%|█████▌    | 77/140 [32:56<14:20, 13.65s/it] 56%|█████▌    | 78/140 [33:15<15:39, 15.15s/it] 56%|█████▋    | 79/140 [33:28<14:41, 14.45s/it] 57%|█████▋    | 80/140 [33:47<15:44, 15.74s/it] 58%|█████▊    | 81/140 [33:59<14:27, 14.70s/it] 59%|█████▊    | 82/140 [34:14<14:20, 14.83s/it] 59%|█████▉    | 83/140 [34:26<13:19, 14.02s/it] 60%|██████    | 84/140 [34:48<15:21, 16.46s/it] 61%|██████    | 85/140 [35:11<16:47, 18.33s/it] 61%|██████▏   | 86/140 [35:26<15:35, 17.32s/it] 62%|██████▏   | 87/140 [36:11<22:36, 25.60s/it] 63%|██████▎   | 88/140 [36:29<20:09, 23.27s/it] 64%|██████▎   | 89/140 [36:59<21:27, 25.25s/it] 64%|██████▍   | 90/140 [37:18<19:39, 23.58s/it] 65%|██████▌   | 91/140 [37:44<19:49, 24.27s/it] 66%|██████▌   | 92/140 [38:08<19:18, 24.14s/it] 66%|██████▋   | 93/140 [38:32<18:46, 23.97s/it] 67%|██████▋   | 94/140 [38:43<15:31, 20.25s/it] 68%|██████▊   | 95/140 [39:09<16:23, 21.85s/it] 69%|██████▊   | 96/140 [39:24<14:39, 19.99s/it] 69%|██████▉   | 97/140 [39:47<14:50, 20.70s/it] 70%|███████   | 98/140 [40:02<13:26, 19.20s/it] 71%|███████   | 99/140 [40:11<10:54, 15.95s/it] 71%|███████▏  | 100/140 [40:46<14:30, 21.75s/it] 72%|███████▏  | 101/140 [41:09<14:23, 22.15s/it] 73%|███████▎  | 102/140 [41:33<14:16, 22.54s/it] 74%|███████▎  | 103/140 [41:52<13:16, 21.52s/it] 74%|███████▍  | 104/140 [42:12<12:41, 21.14s/it] 75%|███████▌  | 105/140 [42:59<16:53, 28.97s/it] 76%|███████▌  | 106/140 [43:20<14:57, 26.39s/it] 76%|███████▋  | 107/140 [43:35<12:41, 23.07s/it] 77%|███████▋  | 108/140 [43:45<10:15, 19.25s/it] 78%|███████▊  | 109/140 [43:58<08:51, 17.16s/it] 79%|███████▊  | 110/140 [44:29<10:43, 21.44s/it] 79%|███████▉  | 111/140 [44:45<09:39, 19.97s/it] 80%|████████  | 112/140 [44:54<07:39, 16.41s/it] 81%|████████  | 113/140 [45:25<09:27, 21.03s/it] 81%|████████▏ | 114/140 [45:36<07:46, 17.96s/it] 82%|████████▏ | 115/140 [45:47<06:36, 15.86s/it] 83%|████████▎ | 116/140 [45:57<05:39, 14.17s/it] 84%|████████▎ | 117/140 [46:35<08:10, 21.33s/it] 84%|████████▍ | 118/140 [46:50<07:04, 19.31s/it] 85%|████████▌ | 119/140 [47:20<07:54, 22.59s/it] 86%|████████▌ | 120/140 [47:55<08:41, 26.10s/it] 86%|████████▋ | 121/140 [48:23<08:26, 26.66s/it] 87%|████████▋ | 122/140 [48:33<06:35, 21.95s/it] 88%|████████▊ | 123/140 [48:50<05:44, 20.27s/it] 89%|████████▊ | 124/140 [49:02<04:44, 17.78s/it] 89%|████████▉ | 125/140 [49:17<04:13, 16.87s/it] 90%|█████████ | 126/140 [49:43<04:34, 19.61s/it] 91%|█████████ | 127/140 [49:59<04:04, 18.77s/it] 91%|█████████▏| 128/140 [50:14<03:29, 17.48s/it] 92%|█████████▏| 129/140 [50:26<02:54, 15.88s/it] 93%|█████████▎| 130/140 [50:36<02:19, 13.98s/it] 94%|█████████▎| 131/140 [50:55<02:20, 15.65s/it] 94%|█████████▍| 132/140 [51:08<01:58, 14.78s/it] 95%|█████████▌| 133/140 [51:24<01:46, 15.18s/it] 96%|█████████▌| 134/140 [52:01<02:10, 21.81s/it] 96%|█████████▋| 135/140 [52:17<01:40, 20.02s/it] 97%|█████████▋| 136/140 [52:37<01:20, 20.03s/it] 98%|█████████▊| 137/140 [53:19<01:19, 26.48s/it] 99%|█████████▊| 138/140 [53:40<00:49, 24.83s/it] 99%|█████████▉| 139/140 [54:03<00:24, 24.48s/it]100%|██████████| 140/140 [54:27<00:00, 24.39s/it]100%|██████████| 140/140 [54:27<00:00, 23.34s/it]
[nltk_data] Error loading wordnet: <urlopen error [Errno 101] Network
[nltk_data]     is unreachable>
/lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/venv/lib/python3.11/site-packages/nltk/translate/bleu_score.py:577: UserWarning: 
The hypothesis contains 0 counts of 2-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/venv/lib/python3.11/site-packages/nltk/translate/bleu_score.py:577: UserWarning: 
The hypothesis contains 0 counts of 3-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/venv/lib/python3.11/site-packages/nltk/translate/bleu_score.py:577: UserWarning: 
The hypothesis contains 0 counts of 4-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
Some weights of RobertaModel were not initialized from the model checkpoint at roberta-large and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
{'longdep_qa': {'bleu1': 0.06996653808340006, 'bleu4': 0.007043681139125255, 'rouge-1': 0.2632927817615956, 'rouge-2': 0.07283051495618605, 'rouge-l': 0.2523242627855339, 'meteor': 0.09717170774857418, 'bert': 0.8297943472862244}}
