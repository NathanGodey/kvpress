Results already exist at /lustre/fswork/projects/rech/awr/uof65ov/kv_cache_comp/kvpress/evaluation/results/ruler__4096__meta-llama--Llama-3.1-8B-Instruct__qfilter__0.5.csv
Using the latest cached version of the dataset since simonjegou/ruler couldn't be found on the Hugging Face Hub (offline mode is enabled).
Found the latest cached dataset configuration '4096' at /lustre/fsn1/projects/rech/awr/uof65ov/hf_cache/simonjegou___ruler/4096/0.0.0/24adceac8a0e6532936e8d721cd9e9084d2e4686 (last modified on Mon Nov 25 16:14:41 2024).
You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:00,  6.04it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00,  6.37it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:00<00:00,  6.51it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00,  7.18it/s]
  0%|          | 0/65 [00:00<?, ?it/s]The `seen_tokens` attribute is deprecated and will be removed in v4.41. Use the `cache_position` model input instead.
  2%|▏         | 1/65 [00:10<11:25, 10.70s/it]  3%|▎         | 2/65 [00:11<04:56,  4.70s/it]  5%|▍         | 3/65 [00:11<02:50,  2.75s/it]  6%|▌         | 4/65 [00:12<01:52,  1.84s/it]  8%|▊         | 5/65 [00:12<01:20,  1.33s/it]  9%|▉         | 6/65 [00:12<01:01,  1.04s/it] 11%|█         | 7/65 [00:13<00:49,  1.18it/s] 12%|█▏        | 8/65 [00:13<00:40,  1.39it/s] 14%|█▍        | 9/65 [00:14<00:35,  1.58it/s] 15%|█▌        | 10/65 [00:14<00:31,  1.72it/s]You seem to be using the pipelines sequentially on GPU. In order to maximize efficiency please use a dataset
 17%|█▋        | 11/65 [00:15<00:29,  1.86it/s] 18%|█▊        | 12/65 [00:15<00:27,  1.94it/s] 20%|██        | 13/65 [00:16<00:25,  2.04it/s] 22%|██▏       | 14/65 [00:16<00:24,  2.08it/s] 23%|██▎       | 15/65 [00:17<00:24,  2.08it/s] 25%|██▍       | 16/65 [00:17<00:23,  2.07it/s] 26%|██▌       | 17/65 [00:18<00:23,  2.07it/s] 28%|██▊       | 18/65 [00:18<00:22,  2.07it/s] 29%|██▉       | 19/65 [00:18<00:22,  2.07it/s] 31%|███       | 20/65 [00:19<00:21,  2.07it/s] 32%|███▏      | 21/65 [00:19<00:21,  2.07it/s] 34%|███▍      | 22/65 [00:21<00:29,  1.45it/s] 35%|███▌      | 23/65 [00:24<01:05,  1.55s/it] 37%|███▋      | 24/65 [00:25<00:56,  1.39s/it] 38%|███▊      | 25/65 [00:26<00:47,  1.18s/it] 40%|████      | 26/65 [00:27<00:46,  1.19s/it] 42%|████▏     | 27/65 [00:28<00:45,  1.20s/it] 43%|████▎     | 28/65 [00:29<00:42,  1.15s/it] 45%|████▍     | 29/65 [00:30<00:40,  1.13s/it] 46%|████▌     | 30/65 [00:32<00:40,  1.16s/it] 48%|████▊     | 31/65 [00:33<00:40,  1.19s/it] 49%|████▉     | 32/65 [00:34<00:37,  1.14s/it] 51%|█████     | 33/65 [00:34<00:29,  1.10it/s] 52%|█████▏    | 34/65 [00:35<00:22,  1.40it/s] 54%|█████▍    | 35/65 [00:35<00:17,  1.72it/s] 55%|█████▌    | 36/65 [00:35<00:14,  1.97it/s] 57%|█████▋    | 37/65 [00:36<00:13,  2.12it/s] 58%|█████▊    | 38/65 [00:36<00:11,  2.26it/s] 60%|██████    | 39/65 [00:36<00:10,  2.42it/s] 62%|██████▏   | 40/65 [00:37<00:09,  2.58it/s] 63%|██████▎   | 41/65 [00:37<00:09,  2.49it/s] 65%|██████▍   | 42/65 [00:37<00:09,  2.54it/s] 66%|██████▌   | 43/65 [00:38<00:07,  2.80it/s] 68%|██████▊   | 44/65 [00:38<00:07,  2.87it/s] 69%|██████▉   | 45/65 [00:38<00:06,  2.96it/s] 71%|███████   | 46/65 [00:40<00:12,  1.52it/s] 72%|███████▏  | 47/65 [00:41<00:15,  1.15it/s] 74%|███████▍  | 48/65 [00:43<00:17,  1.05s/it] 75%|███████▌  | 49/65 [00:44<00:17,  1.11s/it] 77%|███████▋  | 50/65 [00:45<00:17,  1.15s/it] 78%|███████▊  | 51/65 [00:46<00:16,  1.18s/it] 80%|████████  | 52/65 [00:48<00:15,  1.18s/it] 82%|████████▏ | 53/65 [00:49<00:14,  1.19s/it] 83%|████████▎ | 54/65 [00:50<00:13,  1.20s/it] 85%|████████▍ | 55/65 [00:51<00:10,  1.10s/it] 86%|████████▌ | 56/65 [00:52<00:09,  1.01s/it] 88%|████████▊ | 57/65 [00:55<00:14,  1.87s/it] 89%|████████▉ | 58/65 [00:57<00:12,  1.78s/it] 91%|█████████ | 59/65 [00:58<00:09,  1.50s/it] 92%|█████████▏| 60/65 [00:59<00:06,  1.30s/it] 94%|█████████▍| 61/65 [01:02<00:07,  1.96s/it] 95%|█████████▌| 62/65 [01:06<00:07,  2.53s/it] 97%|█████████▋| 63/65 [01:10<00:05,  2.83s/it] 98%|█████████▊| 64/65 [01:13<00:03,  3.02s/it]100%|██████████| 65/65 [01:15<00:00,  2.55s/it]100%|██████████| 65/65 [01:15<00:00,  1.15s/it]
{'cwe': {'string_match': 93.33}, 'fwe': {'string_match': 100.0}, 'niah_multikey_1': {'string_match': 50.0}, 'niah_multikey_2': {'string_match': 0.0}, 'niah_multikey_3': {'string_match': 25.0}, 'niah_multiquery': {'string_match': 20.83}, 'niah_multivalue': {'string_match': 40.0}, 'niah_single_1': {'string_match': 100.0}, 'niah_single_2': {'string_match': 25.0}, 'niah_single_3': {'string_match': 0.0}, 'qa_1': {'string_match': 80.0}, 'qa_2': {'string_match': 37.5}, 'avg': 47.76876923076924}
